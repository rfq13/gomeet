# coturn configuration for GoMeet
# Network configuration
listening-port=3478
tls-listening-port=5349
alt-listening-port=3479
alt-tls-listening-port=5350

# IP configuration
listening-ip=0.0.0.0
relay-ip=${EXTERNAL_IP}
external-ip=${EXTERNAL_IP}

# Authentication
use-auth-secret
static-auth-secret=${TURN_SECRET}
realm=gomeet.local

# User quotas and limits
total-quota=100
user-quota=12
max-bps=64000
max-session-time=86400

# TLS configuration
cert=/etc/coturn/certs/server.crt
pkey=/etc/coturn/certs/server.key
cipher-list="ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305"
ec-curve-name=secp384r1

# Redis integration for distributed deployment
redis-statsdb=${REDIS_URL}/0
redis-userdb=${REDIS_URL}/1

# Logging
log-file=/var/log/turnserver/turnserver.log
verbose
no-multicast-peers
simple-log
syslog

# Security
no-cli
no-tlsv1
no-tlsv1_1
no-stdout-log
secure-stun

# Performance
max-allocate-time=60
max-allocate-bps=128000
min-port=49152
max-port=65535

# WebRTC support
websockets
websocket-port=8080
websocket-ssl-port=8443

# Monitoring
prometheus
prometheus-port=9641

# Additional security settings
no-loopback-peers
no-software-attribute
fingerprint
check-origin-consistency

# Connection settings
stale-nonce=600
max-bps=64000
bps-capacity=0

# Mobility
mobility
no-multicast-peers

# Debug (comment out in production)
#verbose
#debug